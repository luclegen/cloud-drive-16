(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{111:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(30),o=a.n(s),i=(a(69),a(5)),c=a(11),l=a(10),d=(a(70),a(63)),u=a(7),m=a(60),h=a(9),f=a(113),g=a(115),p=a(116),b=a(114),j=new function e(){var t=this;Object(i.a)(this,e),this.isFirstName=function(e){return RegExp(t.firstNamePattern).test(e)},this.isLastName=function(e){return RegExp(t.lastNamePattern).test(e)},this.isEmail=function(e){return RegExp(t.emailPattern).test(e)},this.isDate=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date(parseInt(t)+1+"/"+a+"/"+e);return n.getFullYear()===parseInt(e)&&n.getMonth()===parseInt(t)&&n.getDate()===parseInt(a)},this.isOldEnough=function(e){return(new Date).getFullYear()-parseInt(e)>=5},this.isDigit=function(e){return/^\d{1}$/.test(e)},this.isDigits=function(e){return/^\d+$/.test(e)},this.isImage=function(e){return/\.(gif|jpe?g|tiff?|png|webp|bmp)$/i.test(e)},this.getImage=function(e,a){return e.find((function(e){return e.path===a.path+("/"===a.path?"":"/")+a.name&&t.isImage(e.name)}))},this.isImages=function(e,a){return e.filter((function(e){return e.path===a.path+("/"===a.path?"":"/")+a.name&&t.isImage(e.name)})).length},this.checkPassword=function(e){var t=0,a=Object.freeze({0:"Worst",1:"Bad",2:"Weak",3:"Good",4:"Strong"});return e.length>=8&&t++,/[a-z]/gi.test(e)&&t++,/\d/g.test(e)&&t++,/[.@#$%^&*(),.?":{}|<>]/g.test(e)&&t++,{isStrong:4===t,level:t,strength:a[t]}},this.getQuery=function(e){return new URLSearchParams(window.location.search).get(e)},this.setQuery=function(e,t){var a=new URLSearchParams(window.location.search);a.set(e,t),window.history.replaceState({},"",decodeURIComponent("".concat(window.location.pathname,"?").concat(a)))},this.deleteQuery=function(e){var t=new URLSearchParams(window.location.search);t.delete(e),window.history.replaceState({},"",decodeURIComponent("".concat(window.location.pathname,"?").concat(t)))},this.getToken=function(){return localStorage.getItem("token")||sessionStorage.getItem("token")},this.setToken=function(e){return t.remembered()?localStorage.setItem("token",e):sessionStorage.setItem("token",e)},this.getPayload=function(){return t.loggedIn()?JSON.parse(atob(t.getToken().split(".")[1])):null},this.setId=function(e){return t.remembered()?localStorage.setItem("id",e):sessionStorage.setItem("id",e)},this.getId=function(){return t.remembered()?localStorage.getItem("id"):sessionStorage.getItem("id")},this.setType=function(e){return t.remembered()?localStorage.setItem("type",e):sessionStorage.setItem("type",e)},this.getType=function(){return t.remembered()?localStorage.getItem("type"):sessionStorage.getItem("type")},this.isExpired=function(){return!t.loggedIn()||!!t.getPayload().exp&&1e3*t.getPayload().exp<Date.now()},this.loggedIn=function(){return Boolean(t.getToken())},this.remembered=function(){return"true"===localStorage.getItem("remembered")||"true"===sessionStorage.getItem("remembered")||"false"!==localStorage.getItem("remembered")&&"false"!==sessionStorage.getItem("remembered")&&null},this.logout=function(){localStorage.clear(),sessionStorage.clear(),window.location.reload()},this.firstNamePattern="^[A-Z]{1}[a-z]*$",this.lastNamePattern="^[A-Z]{1}[a-z]*(?: [A-Z]{1}[a-z]*)*(?: [A-Z]{1}[a-z]*)?$",this.emailPattern="[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$"},O=a(12),x=a.n(O),v=a(22),y=a(31),N=a.n(y),w=N.a.create({timeout:3e3,headers:{"Content-Type":"application/json"}});w.interceptors.response.use((function(e){return e}),function(){var e=Object(v.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.response?alert(t.response.data.msg):console.warn(t),e.abrupt("return",Promise.reject(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var S=w,I=N.a.create();I.interceptors.request.use(function(){var e=Object(v.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.headers={Authorization:"Bearer ".concat(j.getToken()),Accept:"application/json","Content-Type":"application/json"},e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)})),I.interceptors.response.use((function(e){return e}),function(){var e=Object(v.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.response&&440===t.response.status&&window.confirm(t.response.data.msg)?(j.logout(),"/"!==window.location.pathname&&window.open("/")):t.response?alert(t.response.data.msg):console.warn(t),e.abrupt("return",Promise.reject(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var k=I,C="".concat("http://localhost:5000/","user/"),D=new function e(){Object(i.a)(this,e),this.create=function(e){return S.post(C,e)},this.read=function(){return k.get(C)}},F=a(0),E=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).toggle=function(){return n.setState({isHover:!n.state.isHover})},n.toggleDropdown=function(){return n.setState({dropdownOpened:!n.state.dropdownOpened})},n.getSearchBar=function(){return document.querySelector(".search-bar")},n.getSearchIn=function(){return document.querySelector(".input-search")},n.getSearchBtn=function(){return document.querySelector(".btn-search")},n.open=function(){n.state.width<801&&(n.getSearchBar().style.position="absolute",n.getSearchBar().style.width="100%",n.getSearchBar().style.left="0",n.getSearchBar().style.background="white",n.getSearchIn().style.display="block",n.getSearchIn().focus(),n.getSearchBtn().style.color="blue",n.setState({opened:!0}))},n.reset=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.getSearchBar().style.width=e?"auto":(n.state.width<1025?250:500)+"px",n.getSearchBar().style.position="static",n.getSearchBar().style.background=e?"blue":"#e1dfdd",n.getSearchBtn().style.color=e?"white":"blue",n.getSearchIn().style.display=e?"none":"flex"},n.coloring=function(e){if("select"===e.type&&n.setState({selected:!0}),"blur"===e.type&&n.setState({selected:!1}),n.state.width>800){var t=n.state.keyword||n.state.selected||"mouseenter"===e.type?"white":"#e1dfdd";"select"===e.type&&(t="white"),"blur"!==e.type||n.state.keyword||(t="#e1dfdd"),document.querySelector(".search-bar").style.background=t}else"mouseleave"===e.type&&(n.reset(),n.setState({opened:!1}))},n.setKeyword=function(e){return n.setState({keyword:e.target.value})},n.componentDidMount=function(){j.loggedIn()&&D.read().then((function(e){n.setState(e.data.user),n.setState({firstName:e.data.user.name.first})}))},n.componentDidUpdate=function(){return window.onresize=function(){n.setState({width:window.innerWidth}),n.reset(n.state.width<801),n.state.opened&&n.open()}},n.render=function(){return Object(F.jsxs)("header",{children:[Object(F.jsxs)("a",{className:"logo",href:"/",onMouseEnter:n.toggle,onMouseLeave:n.toggle,children:[Object(F.jsx)("img",{className:"logo-img ".concat(n.state.width>560&&"mr-1"),src:"logo"+(n.state.isHover?".hover":"")+".png",alt:"Logo"}),n.state.width>560&&"CloudDrive16"]}),Object(F.jsx)("div",{className:"search-bar",onMouseEnter:n.coloring,onMouseLeave:n.coloring,children:Object(F.jsxs)("form",{className:"form-search",children:[Object(F.jsx)("button",{className:"btn-search",type:n.state.width>800||n.state.opened&&n.state.keyword?"submit":"button",disabled:n.state.width>800&&!n.state.keyword,onClick:n.open,children:Object(F.jsx)("i",{className:"material-icons",children:"search"})}),Object(F.jsx)("input",{className:"input-search",type:"search",placeholder:"Search for anything",onSelect:n.coloring,onBlur:n.coloring,onInput:n.setKeyword})]})}),Object(F.jsxs)(f.a,{className:"dropdown-avatar",isOpen:n.state.dropdownOpened,toggle:n.toggleDropdown,children:[j.loggedIn()?Object(F.jsx)(g.a,{className:"avatar",title:n.state.fullName,children:n.state.avatar?Object(F.jsx)("img",{className:"avatar-img",src:n.state.avatar,alt:"".concat(n.state.firstName,"'s avatar")}):"root"===n.state.role?Object(F.jsx)("i",{className:"material-icons",children:"security"}):"admin"===n.state.role?Object(F.jsx)("i",{className:"material-icons",children:"local_police"}):Object(F.jsx)("i",{className:"material-icons",children:"account_circle"})}):Object(F.jsx)("a",{className:"link-help",href:"/help",target:"_blank",children:Object(F.jsx)("i",{className:"material-icons",children:"help_outline"})}),Object(F.jsxs)(p.a,{className:"dropdown-menu-avatar",children:[Object(F.jsxs)(b.a,{className:"dropdown-item-profile",tag:"a",href:"/profile",children:[Object(F.jsx)("p",{className:"text-profile",children:"My profile"}),Object(F.jsx)("i",{className:"material-icons",children:"info"})]}),Object(F.jsx)(b.a,{divider:!0}),Object(F.jsxs)(b.a,{className:"dropdown-item-profile",tag:"a",href:"/help",children:[Object(F.jsx)("p",{className:"text-help",children:"Help"}),Object(F.jsx)("i",{className:"material-icons",children:"help_outline"})]}),Object(F.jsx)(b.a,{divider:!0}),Object(F.jsxs)(b.a,{className:"dropdown-item-logout",onClick:n.logout,children:[Object(F.jsx)("p",{className:"text-logout",children:"Sign out"}),Object(F.jsx)("i",{className:"material-icons",children:"logout"})]})]})]})]})},n.setKeyword=n.setKeyword.bind(Object(h.a)(n)),n.state={firstName:"",fullName:"",avatar:"",role:"",isHover:!1,selected:!1,opened:!1,keyword:"",width:window.innerWidth,dropdownOpened:!1},n}return Object(m.a)(a,[{key:"logout",value:function(){j.logout()}}]),a}(n.Component),P="".concat("http://localhost:5000/","auth/"),R=new function e(){Object(i.a)(this,e),this.available=function(e){return S.get("".concat(P).concat(e))},this.authenticate=function(e){return S.post(P,e)},this.verify=function(e){return k.put(P,e)}},q={firstName:"",lastName:"",email:"",password:"",confirm:"",day:(new Date).getDate().toString(),month:(new Date).getMonth().toString(),year:(new Date).getFullYear().toString(),sex:"",available:!0,submitted:!1},T=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).setFirstName=function(e){return n.setState({firstName:e.target.value})},n.setLastName=function(e){return n.setState({lastName:e.target.value})},n.setEmail=function(e){return n.setState({email:e.target.value})},n.setPassword=function(e){return n.setState({password:e.target.value})},n.setConfirm=function(e){return n.setState({confirm:e.target.value})},n.setDay=function(e){return n.setState({day:e.target.value})},n.setMonth=function(e){return n.setState({month:e.target.value})},n.setYear=function(e){return n.setState({year:e.target.value})},n.setSex=function(e){return n.setState({sex:e.target.value})},n.checkSex=function(e){"form-check-female"!==e.target.className&&"form-check-male"!==e.target.className&&"form-check-other"!==e.target.className||n.setState({sex:Array.from(e.target.children)[1].value})},n.enterFirstName=function(e){return e.target.setCustomValidity(e.target.value?j.isFirstName(e.target.value)?"":"Invalid first name.":"This field is required.")},n.enterLastName=function(e){return e.target.setCustomValidity(e.target.value?j.isLastName(e.target.value)?"":"Invalid last name.":"This field is required.")},n.enterEmail=function(){var e=Object(v.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.available(t.target.value);case 2:a=e.sent.data.available,n.setState({available:a}),t.target.setCustomValidity(t.target.value?j.isEmail(t.target.value)?a?"Email is duplicate.":"":"Invalid email.":"This field is required.");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.enterPassword=function(e){var t=j.checkPassword(e.target.value);e.target.setCustomValidity(e.target.value?t.isStrong?"":"Please choose a stronger password. Try a mix of letters, numbers, and symbols (use 8 or more characters).":"This field is required."),document.querySelector("meter").value=t.level,n.setState({strength:t.strength})},n.enterConfirm=function(e){return e.target.setCustomValidity(e.target.value?e.target.value===n.state.password?"":"The passwords do not match.":"This field is required.")},n.chooseDateOfBirth=function(e){document.querySelector("#dayRegister").setCustomValidity(j.isDate("yearRegister"===e.target.id?e.target.value:n.state.year,"monthRegister"===e.target.id?e.target.value:n.state.month,"dayRegister"===e.target.id?e.target.value:n.state.day)?"":"Invalid date of birth."),document.querySelector("#yearRegister").setCustomValidity((new Date).getFullYear()-parseInt("yearRegister"===e.target.id?e.target.value:n.state.year)>=5?"":"You must be 5 years or older")},n.chooseSex=function(){return document.querySelector("#female-register").setCustomValidity(n.state.sex?"":"Please select one of these options")},n.getIsValidDateOfBirth=function(){return(n.state.submitted||n.state.day!==(new Date).getDate().toString()||n.state.month!==(new Date).getMonth().toString()||n.state.year!==(new Date).getFullYear().toString())&&(j.isDate(n.state.year,n.state.month,n.state.day)&&j.isOldEnough(n.state.year)?"is-valid":"is-invalid")},n.onSubmit=function(e){e.preventDefault(),n.setState({submitted:!0}),n.state.password===n.state.confirm&&n.state.firstName&&n.state.lastName&&n.state.email&&n.state.password&&n.state.confirm&&n.state.day&&n.state.month&&n.state.year&&(document.querySelector("#female-register").setCustomValidity(n.state.sex?"":"Please select one of these options"),document.querySelector("#yearRegister").setCustomValidity(j.isOldEnough(n.state.year)?"":"You must be 5 years or older"),D.create(n.state).then((function(e){alert(e.data.msg),document.querySelector(".form-register").reset(),document.querySelector("meter").value=0,n.setState(q)})))},n.componentDidUpdate=function(){return window.onbeforeunload=function(){return!!(n.state.firstName||n.state.lastName||n.state.email||n.state.password||n.state.day||n.state.month||n.state.year||n.state.sex)||void 0}},n.render=function(){var e=Object.freeze({FEMALE:"female",MALE:"male",OTHER:"other"});return Object(F.jsx)("section",{className:"section-register",children:Object(F.jsxs)("form",{className:"form-register",onSubmit:n.onSubmit,children:[Object(F.jsx)("button",{className:"close",type:"reset",onClick:n.props.close,children:Object(F.jsx)("i",{className:"material-icons",children:"close"})}),Object(F.jsx)("h1",{className:"h1-register",children:"Sign Up"}),Object(F.jsxs)("div",{className:"form-row",children:[Object(F.jsxs)("div",{className:"form-floating col-md-6 ".concat(n.state.firstName&&"float"),children:[Object(F.jsx)("input",{className:"form-control ".concat(n.state.firstName&&(j.isFirstName(n.state.firstName)?"is-valid":"is-invalid")),id:"firstNameRegister",type:"text",pattern:j.firstNamePattern,onInput:n.enterFirstName,onInvalid:n.enterFirstName,onChange:n.setFirstName,required:!0}),Object(F.jsx)("label",{htmlFor:"firstNameRegister",children:"First name"})]}),Object(F.jsxs)("div",{className:"form-floating col-md-6 ".concat(n.state.lastName&&"float"),children:[Object(F.jsx)("input",{className:"form-control ".concat(n.state.lastName&&(j.isLastName(n.state.lastName)?"is-valid":"is-invalid")),id:"lastNameRegister",type:"text",pattern:j.lastNamePattern,onInput:n.enterLastName,onInvalid:n.enterLastName,onChange:n.setLastName,required:!0}),Object(F.jsx)("label",{htmlFor:"lastNameRegister",children:"Last name"})]})]}),Object(F.jsxs)("div",{className:"form-floating ".concat(n.state.email&&"float"),children:[Object(F.jsx)("input",{className:"form-control ".concat(n.state.email&&(j.isEmail(n.state.email)&&!n.state.available?"is-valid":"is-invalid")),id:"addressRegister",type:"email",pattern:j.emailPattern,onInput:n.enterEmail,onInvalid:n.enterEmail,onChange:n.setEmail,required:!0}),Object(F.jsx)("label",{htmlFor:"addressRegister",children:"Email"})]}),Object(F.jsxs)("div",{className:"form-row",children:[Object(F.jsxs)("div",{className:"form-floating col-md-6 ".concat(n.state.password&&"float"," form-floating-password"),children:[Object(F.jsx)("input",{className:"form-control ".concat(n.state.password&&(j.checkPassword(n.state.password).isStrong?"is-valid":"is-invalid")),id:"passwordRegister",type:"password",minLength:"8",onInput:n.enterPassword,onChange:n.setPassword,required:!0}),Object(F.jsx)("label",{htmlFor:"passwordRegister",children:"Password"})]}),Object(F.jsxs)("div",{className:"form-floating col-md-6 ".concat(n.state.confirm&&"float"," form-floating-confirm"),children:[Object(F.jsx)("input",{className:"form-control ".concat(n.state.confirm&&(n.state.confirm===n.state.password?"is-valid":"is-invalid")),id:"confirmRegister",type:"password",onInput:n.enterConfirm,onInvalid:n.enterConfirm,onChange:n.setConfirm,required:!0}),Object(F.jsx)("label",{htmlFor:"confirmRegister",children:"Confirm"})]})]}),Object(F.jsx)("meter",{id:"passwordStrengthRegister",title:"Use 8 or more characters with a mix of letters, numbers & symbols",max:"4",value:"0"}),Object(F.jsx)("div",{className:"form-group-password-strength",children:n.state.strength&&Object(F.jsx)("label",{className:"password-strength",htmlFor:"passwordStrengthRegister",children:j.checkPassword(n.state.password).strength})}),Object(F.jsx)("label",{className:"label-group ".concat(n.getIsValidDateOfBirth()),htmlFor:"dateOfBirthRegister",children:"Date of birth"}),Object(F.jsxs)("div",{className:"form-row",id:"dateOfBirthRegister",children:[Object(F.jsxs)("div",{className:"form-floating col-md-4 ".concat(n.state.day&&"float"),children:[Object(F.jsx)("select",{className:"form-control-day ".concat(n.getIsValidDateOfBirth()),id:"dayRegister",required:!0,value:n.state.day,onInput:n.chooseDateOfBirth,onChange:n.setDay,children:"0".repeat(31).split("").map((function(e,t){return Object(F.jsx)("option",{value:t+1,children:t+1},t)}))}),Object(F.jsx)("label",{htmlFor:"dayRegister",children:"Day"})]}),Object(F.jsxs)("div",{className:"form-floating col-md-4 ".concat(n.state.month&&"float"),children:[Object(F.jsx)("select",{className:"form-control-month ".concat(n.getIsValidDateOfBirth()),id:"monthRegister",required:!0,value:n.state.month,onInput:n.chooseDateOfBirth,onChange:n.setMonth,children:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((function(e,t){return Object(F.jsx)("option",{value:t,children:e},t)}))}),Object(F.jsx)("label",{htmlFor:"monthRegister",children:"Month"})]}),Object(F.jsxs)("div",{className:"form-floating col-md-4 ".concat(n.state.year&&"float"),children:[Object(F.jsx)("select",{className:"form-control-year ".concat(n.getIsValidDateOfBirth()),id:"yearRegister",required:!0,"aria-describedby":"validationDateOfBirth",onInput:n.chooseDateOfBirth,onChange:n.setYear,children:"0".repeat(200).split("").map((function(e,t){return Object(F.jsx)("option",{value:(new Date).getFullYear()-t,children:(new Date).getFullYear()-t},t)}))}),Object(F.jsx)("label",{htmlFor:"yearRegister",children:"Year"})]})]}),Object(F.jsx)("label",{className:"label-group ".concat(n.state.sex?"is-valid":n.state.submitted&&!n.state.sex&&"is-invalid"),htmlFor:"genderRegister",children:"Gender"}),Object(F.jsxs)("div",{className:"form-row",id:"genderRegister",children:[Object(F.jsx)("div",{className:"form-group col-md-4",children:Object(F.jsxs)("div",{className:"form-check-female ".concat(n.state.sex?"is-valid":n.state.submitted&&!n.state.sex&&"is-invalid"),onClick:n.checkSex,children:[Object(F.jsx)("label",{className:"form-check-label flex-fill",htmlFor:"female-register",children:"Female"}),Object(F.jsx)("input",{className:"form-check-input is-valid",id:"female-register",type:"radio",name:"sex",value:e.FEMALE,checked:n.state.sex===e.FEMALE,onInput:n.chooseSex,onChange:n.setSex})]})}),Object(F.jsx)("div",{className:"form-group col-md-4",children:Object(F.jsxs)("div",{className:"form-check-male ".concat(n.state.sex?"is-valid":n.state.submitted&&!n.state.sex&&"is-invalid"),onClick:n.checkSex,children:[Object(F.jsx)("label",{className:"form-check-label flex-fill",htmlFor:"male-register",children:"Male"}),Object(F.jsx)("input",{className:"form-check-input",id:"male-register",type:"radio",name:"sex",value:e.MALE,checked:n.state.sex===e.MALE,onInput:n.chooseSex,onChange:n.setSex})]})}),Object(F.jsx)("div",{className:"form-group col-md-4",children:Object(F.jsxs)("div",{className:"form-check-other ".concat(n.state.sex?"is-valid":n.state.submitted&&!n.state.sex&&"is-invalid"),onClick:n.checkSex,children:[Object(F.jsx)("label",{className:"form-check-label flex-fill",htmlFor:"other-register",children:"Other"}),Object(F.jsx)("input",{className:"form-check-input",id:"other-register",type:"radio",name:"sex",value:e.OTHER,checked:n.state.sex===e.OTHER,onInput:n.chooseSex,onChange:n.setSex})]})})]}),Object(F.jsx)("div",{className:"form-row-sign-up",children:Object(F.jsx)("button",{className:"btn-sign-up",type:"submit",children:"Sign up"})})]})})},n.setFirstName=n.setFirstName.bind(Object(h.a)(n)),n.setLastName=n.setLastName.bind(Object(h.a)(n)),n.setEmail=n.setEmail.bind(Object(h.a)(n)),n.setPassword=n.setPassword.bind(Object(h.a)(n)),n.setConfirm=n.setConfirm.bind(Object(h.a)(n)),n.setDay=n.setDay.bind(Object(h.a)(n)),n.setMonth=n.setMonth.bind(Object(h.a)(n)),n.setYear=n.setYear.bind(Object(h.a)(n)),n.setSex=n.setSex.bind(Object(h.a)(n)),n.state=q,n}return a}(n.Component),M="".concat("http://localhost:5000/","code/"),B=new function e(){Object(i.a)(this,e),this.create=function(){return k.post(M)}},L={email:"",password:"",remembered:!1,available:!1,visible:!1,opened:!1},A=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).setEmail=function(e){return n.setState({email:e.target.value})},n.setPassword=function(e){return n.setState({password:e.target.value})},n.setRemembered=function(e){return n.setState({remembered:e.target.checked})},n.enterEmail=function(){var e=Object(v.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.value){e.next=7;break}return e.next=3,R.available(t.target.value);case 3:a=e.sent.data.available,t.target.setCustomValidity(j.isEmail(t.target.value)?a?"":"Email not registered":"Invalid email!"),n.setState({available:a,visible:!1,password:""}),setTimeout((function(){document.querySelector(".form-group-password")&&(document.querySelector(".form-group-password").style.height=0),document.querySelector(".input-email").style.width="260px"}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.open=function(){return n.setState({opened:!0})},n.close=function(){return n.setState({opened:!1})},n.onSubmit=function(e){e.preventDefault(),n.state.email&&(n.setState({visible:!0}),setTimeout((function(){document.querySelector(".form-group-password").style.height="39px",document.querySelector(".input-email").style.width="315px",document.querySelector(".input-password").focus(),n.state.password&&R.authenticate(n.state).then((function(e){n.state.remembered?localStorage.setItem("remembered",n.state.remembered):sessionStorage.setItem("remembered",n.state.remembered),j.setToken(e.data.token),n.setState(L),j.getPayload().activated||(alert("Your session exists for 5 minutes."),B.create()),window.location.reload()}))})))},n.componentDidUpdate=function(){return window.onbeforeunload=function(){return!(!n.state.email&&!n.password)||void 0}},n.render=function(){return Object(F.jsxs)("section",{className:"section-only",children:[Object(F.jsxs)("form",{className:"form-only",onSubmit:n.onSubmit,children:[Object(F.jsx)("img",{className:"logo-img",src:"/logo.png",alt:"CloudDrive16 logo"}),Object(F.jsxs)("h1",{className:"h1-only",children:["Sign in to ","CloudDrive16"]}),Object(F.jsxs)("div",{className:"form-group-email ".concat(n.state.visible?"rounded-top":"rounded"),children:[Object(F.jsx)("input",{className:"input-email",type:"email",name:"email",placeholder:"Email",value:n.state.email,pattern:j.emailPattern,onInput:n.enterEmail,onInvalid:n.enterEmail,onChange:n.setEmail,title:"Please fill out this field.",required:!0}),!n.state.visible&&Object(F.jsx)("button",{className:"btn-input",type:"submit",disabled:!n.state.email,hidden:!0,children:Object(F.jsx)("i",{className:"material-icons",children:"input"})})]}),Object(F.jsx)("div",{className:"form-group-container",children:n.state.visible&&n.state.email&&Object(F.jsxs)("div",{className:"form-group-password",children:[Object(F.jsx)("input",{className:"input-password",type:"password",name:"password",placeholder:"Password",value:n.state.password,onChange:n.setPassword,required:!0}),Object(F.jsx)("button",{className:"btn-input",type:"submit",disabled:!n.state.password,children:Object(F.jsx)("i",{className:"material-icons",children:"input"})})]})}),Object(F.jsxs)("div",{className:"form-check-remember",children:[Object(F.jsx)("input",{className:"remember-me-input",id:"remember-me",type:"checkbox",name:"remember-me",value:n.state.remembered,onChange:n.setRemembered}),Object(F.jsx)("label",{className:"remember-me-label",htmlFor:"remember-me",children:"Keep me signed in"})]}),Object(F.jsxs)("a",{href:"/find-account",target:"_blank",rel:"noopener noreferrer",children:["Forgotten password? ",Object(F.jsx)("i",{className:"fas fa-external-link-alt"})]}),Object(F.jsx)("button",{className:"btn-create-account",type:"button",onClick:n.open,children:"Create New Account"})]}),n.state.opened&&Object(F.jsx)(T,{close:n.close})]})},n.setEmail=n.setEmail.bind(Object(h.a)(n)),n.setPassword=n.setPassword.bind(Object(h.a)(n)),n.setRemembered=n.setRemembered.bind(Object(h.a)(n)),n.state=L,n}return a}(n.Component),_=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).getIndex=function(e){return Array.from(document.querySelector(".form-row").children).findIndex((function(t){return t===e}))},e.getInput=function(){return document.querySelectorAll(".form-control-digit")},e.select=function(e){return e.target.select()},e.enterNumber=function(t){var a=[e.getIndex(t.target.closest(".form-group")),e.getInput()],n=a[0],r=a[1];if(t.target.value.length>1)return r[n].value=t.target.value[0];n<5&&j.isDigit(r[n].value)&&1===r[n].value.length&&r[n+1].focus(),e.isSubmit()&&e.onSubmit(t)},e.clearNumber=function(t){var a=[e.getIndex(t.target.closest(".form-group")),e.getInput()],n=a[0],r=a[1];8===t.keyCode&&n>0&&""===t.target.value&&r[n-1].focus()},e.pasteNumber=function(t){var a=[e.getIndex(t.target.closest(".form-group")),e.getInput()],n=a[0],r=a[1],s=(t.clipboardData||window.clipboardData).getData("text"),o=s.length>6-n?6-n:s.length,i=o+n>5?5:o+n;setTimeout((function(){r[n].value=j.isDigit(s[0])?s[0]:null,j.isDigits(s)&&r[i].focus()}));for(var c=n,l=0;l<o;c++,l++)r[c].value=j.isDigit(s[l])?s[l]:null;e.isSubmit()&&e.onSubmit(t)},e.send=function(e){e.preventDefault(),B.create().then((function(e){return alert(e.data.msg)}))},e.isSubmit=function(){return 6==="0".repeat(6).split("").map((function(e,t){return document.querySelectorAll(".form-control-digit")[t].value})).filter((function(e){return j.isDigit(e)})).length},e.onSubmit=function(e){e.preventDefault(),R.verify({content:Array.from(document.querySelectorAll(".form-control-digit")).map((function(e){return e.value})).join("")}).then((function(e){j.setToken(e.data.token),window.location.reload()})).catch((function(){document.querySelector(".form-only").reset(),document.querySelector(".form-control-digit").focus()}))},e.render=function(){return Object(F.jsx)("section",{className:"section-only",children:Object(F.jsxs)("form",{className:"form-only",onSubmit:e.onSubmit,children:[Object(F.jsx)("img",{className:"logo-img",src:"/logo.png",alt:"CloudDrive16 logo"}),Object(F.jsx)("h1",{className:"h1-only",children:"Activate your account"}),Object(F.jsx)("p",{children:"We sent a code to your email. Please enter the verification code."}),Object(F.jsx)("div",{className:"form-row",children:"0".repeat(6).split("").map((function(t,a){return Object(F.jsx)("div",{className:"form-group",children:Object(F.jsx)("input",{className:"form-control-digit",type:"number",maxLength:"1",onClick:e.select,onInput:e.enterNumber,onDrop:e.enterNumber,onKeyUp:e.clearNumber,onKeyDown:e.clearNumber,onPaste:e.pasteNumber,required:!0})},a)}))}),Object(F.jsx)("a",{href:"/",onClick:e.send,children:"Resend Code"})]})})},e}return a}(n.Component),Q="".concat("http://localhost:5000/","folder/"),V=new function e(){Object(i.a)(this,e),this.create=function(e){return k.post(Q,e)},this.read=function(e){return k.get("".concat(Q).concat(e))},this.update=function(e,t){return k.put("".concat(Q).concat(e),t)},this.delete=function(e){return k.patch("".concat(Q).concat(e))},this.restore=function(e){return k.patch("".concat(Q,"r/").concat(e))},this.deleteForever=function(e){return k.delete("".concat(Q).concat(e))}},Y="".concat("http://localhost:5000/","folders/"),U=new function e(){Object(i.a)(this,e),this.read=function(){return k.get(Y)}},z="".concat("http://localhost:5000/","file/"),H=new function e(){Object(i.a)(this,e),this.create=function(e){return k.post(z,e)},this.read=function(e){return k.get("".concat(z).concat(e))},this.update=function(e,t){return k.put("".concat(z).concat(e),t)},this.delete=function(e){return k.patch("".concat(z).concat(e))},this.restore=function(e){return k.patch("".concat(z,"r/").concat(e))},this.deleteForever=function(e){return k.delete("".concat(z).concat(e))}},J="".concat("http://localhost:5000/","files/"),K=new function e(){Object(i.a)(this,e),this.create=function(e){return k.post(J,e)},this.read=function(){return k.get(J)}},$=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).return=function(){j.deleteQuery("location"),n.setState({location:""})},n.setTrash=function(){j.setQuery("location","trash"),n.setState({location:"trash"})},n.save=function(e){var t=new FormData,a=[];t.append("path",n.state.path),Array.from(e.target.files).forEach((function(e){return a.push(e.name)&&t.append("files",e,e.name)})),t.append("names",JSON.stringify(a)),K.create(t)},n.upload=function(){return document.getElementById("files").click()},n.download=function(){return window.location.href="http://localhost:5000/file/d/"+j.getId()},n.create=function(){return V.create({name:prompt("Create folder","New folder"),path:n.state.path})},n.open=function(e){var t=n.state.folders.find((function(t){return t._id===e.target.closest(".li-folder").id}));n.setState({path:("/"===n.state.path?n.state.path:n.state.path+"/")+t.name}),j.setQuery("id",t._id)},n.rename=function(){return"folder"===j.getType()?V.read(j.getId()).then((function(e){return V.update(j.getId(),{name:prompt("Rename folder",e.data.folder.name)})&&setTimeout((function(){return window.location.reload()}),1e3)})):H.read(j.getId()).then((function(e){return H.update(j.getId(),{name:prompt("Rename file",e.data.file.name)})&&setTimeout((function(){return window.location.reload()}),1e3)}))},n.delete=function(){return"folder"===j.getType()?"trash"===j.getQuery("location")?V.deleteForever(j.getId()):V.delete(j.getId()):"trash"===j.getQuery("location")?H.deleteForever(j.getId()):H.delete(j.getId())},n.restore=function(){return"folder"===j.getType()?V.restore(j.getId()):H.restore(j.getId())},n.choose=function(e){e.preventDefault(),n.getMenuFolder().style.display="block",n.getMenuFolder().style.top="".concat(e.clientY,"px"),n.getMenuFolder().style.left="".concat(e.clientX,"px"),j.setId(e.target.closest(/file|img/g.test(e.target.className)?".li-file":/folder/g.test(e.target.className)?".li-folder":null).id),j.setType(/file/g.test(e.target.className)?"file":/folder/g.test(e.target.className)?"folder":null),document.querySelector(".dropdown-item-dowload").style.setProperty("display",/folder/g.test(e.target.className)?"none":"flex","important")},n.clickOut=function(e){return n.getMenuFolder().style.display="none"},n.getMenuFolder=function(){return document.querySelector(".dropdown-menu-folder")},n.access=function(e){var t=Number.parseInt(e.target.id),a=1===t?"/":n.state.path.split("/").slice(0,t).join("/"),r=n.state.folders.find((function(e){return e.path===a}));n.setState({path:a||"/"}),j.setQuery("id",0===Number.parseInt(e.target.id)?"root":r._id)},n.componentDidMount=function(){j.loggedIn()&&D.read().then((function(e){return n.setState({fullName:e.data.user.fullName})})),window.location.search||(window.location.search="id=root")},n.componentDidUpdate=function(){U.read().then((function(e){var t=e.data.folders.filter((function(e){return"trash"===j.getQuery("location")?e.inTrash:!e.inTrash})),a="root"===j.getQuery("id")?{path:"/",name:""}:e.data.folders.find((function(e){return e._id===j.getQuery("id")})),r=""===a.name?"/":"/"===a.path?a.path+a.name:a.path+"/"+a.name;n.setState({folders:t,items:t.filter((function(e){return e.path===r})),path:r}),K.read().then((function(e){var t=e.data.files.filter((function(e){return"trash"===j.getQuery("location")?e.inTrash:!e.inTrash}));n.setState({files:t,itemFiles:t.filter((function(e){return e.path===r}))})}))}))},n.render=function(){return Object(F.jsxs)("section",{className:"section-files",onClick:n.clickOut,children:[Object(F.jsxs)("ul",{className:"dropdown-menu-folder",children:[Object(F.jsxs)("li",{className:"dropdown-item-dowload",onClick:n.download,children:[Object(F.jsx)("i",{className:"material-icons",children:"file_download"}),"Download"]}),Object(F.jsxs)("li",{className:"dropdown-item-rename",onClick:n.rename,children:[Object(F.jsx)("i",{className:"material-icons",children:"drive_file_rename_outline"}),"Rename"]}),"trash"===j.getQuery("location")&&Object(F.jsxs)("li",{className:"dropdown-item-restore",onClick:n.restore,children:[Object(F.jsx)("i",{className:"material-icons",children:"restore"}),"Restore"]}),Object(F.jsxs)("li",{className:"dropdown-item-delete",onClick:n.delete,children:[Object(F.jsx)("i",{className:"material-icons",children:"trash"===j.getQuery("location")?"delete_forever":"delete"}),"Delete ","trash"===j.getQuery("location")&&"forever"]})]}),Object(F.jsxs)("nav",{className:"left-nav col-2",id:"leftNav",children:[Object(F.jsx)("div",{className:"top-left-nav",children:Object(F.jsx)("label",{htmlFor:"leftNav",children:Object(F.jsx)("strong",{children:n.state.fullName})})}),Object(F.jsxs)("ul",{className:"list-group",children:[Object(F.jsxs)("li",{className:"list-group-item-files ".concat(!n.state.location&&"active"),onClick:n.return,children:[Object(F.jsx)("i",{className:"material-icons",children:"folder"})," My files"]}),Object(F.jsxs)("li",{className:"list-group-item-trash ".concat("trash"===n.state.location&&"active"),onClick:n.setTrash,children:[Object(F.jsx)("i",{className:"material-icons",children:"delete"})," Trash"]})]})]}),Object(F.jsxs)("div",{className:"right-content col-10",children:[Object(F.jsxs)("div",{className:"command-bar shadow-sm",children:[Object(F.jsxs)("button",{className:"btn-new-folder",onClick:n.create,children:[Object(F.jsx)("i",{className:"material-icons",children:"create_new_folder"})," New"]}),Object(F.jsx)("input",{type:"file",id:"files",hidden:!0,onChange:n.save}),Object(F.jsxs)("button",{className:"btn-new-folder",onClick:n.upload,children:[Object(F.jsx)("i",{className:"material-icons",children:"publish"})," Upload"]})]}),Object(F.jsx)("div",{className:"path-bar",children:"/"===n.state.path?Object(F.jsx)("strong",{children:"My files"}):n.state.path.split("/").map((function(e,t,a){return Object(F.jsx)("div",{children:0===t?Object(F.jsxs)("div",{className:"dir",children:[Object(F.jsx)("p",{className:"dir-parent",id:t,onClick:n.access,children:"My files"}),Object(F.jsx)("p",{children:"\xa0>\xa0"})]}):t===a.length-1?Object(F.jsx)("p",{children:Object(F.jsx)("strong",{children:e})}):Object(F.jsxs)("div",{className:"dir",children:[Object(F.jsx)("p",{className:"dir-parent",id:t,onClick:n.access,children:e}),Object(F.jsx)("p",{children:"\xa0>\xa0"})]})},t)}))}),Object(F.jsxs)("ul",{className:"ls-folder",children:[n.state.items.map((function(e,t,a){return a.length?Object(F.jsxs)("li",{className:"li-folder",id:e._id,onClick:n.open,onContextMenu:n.choose,children:[Object(F.jsx)("img",{className:"bg-folder",src:"svg/lg-bg.svg",alt:"background folder"}),j.isImages(n.state.files,e)?Object(F.jsx)("img",{className:"img",src:"".concat("http://localhost:5000/images/?image=").concat(j.getPayload()._id,"/files/").concat(j.getImage(n.state.files,e).path,"/").concat(j.getImage(n.state.files,e).name),alt:"forceground folder"}):Object(F.jsx)("div",{className:"file"}),j.isImages(n.state.files,e)?Object(F.jsx)("img",{className:"fg-folder",src:"svg/lg-fg-media.svg",alt:"forceground folder",onContextMenu:n.choose}):Object(F.jsx)("img",{className:"fg-folder",src:"svg/lg-fg.svg",alt:"forceground folder"}),Object(F.jsx)("label",{className:"label-folder",htmlFor:"folder".concat(t),children:e.name})]},t):Object(F.jsx)("li",{children:"This folder is empty"})})),n.state.itemFiles.map((function(e,t,a){return Object(F.jsxs)("li",{className:"li-file",id:e._id,onContextMenu:n.choose,children:[j.isImage(e.name)?Object(F.jsx)("img",{className:"bg-img",src:"".concat("http://localhost:5000/images/?image=").concat(j.getPayload()._id,"/files/").concat(e.path,"/").concat(e.name),alt:"Img ".concat(t)}):Object(F.jsx)("i",{className:"material-icons bg-file",children:"description"}),Object(F.jsx)("label",{className:"label-file",htmlFor:"folder".concat(t),children:e.name})]},t)}))]})]})]})},n.state={fullName:"",location:"",opened:!1,path:"/",name:"",folder:{_id:"root",path:"/",name:"root"},folders:[],items:[],file:null,ready:!1,files:[],itemFiles:[]},n}return a}(n.Component),W=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).render=function(){return Object(F.jsx)("main",{children:j.loggedIn()?j.getPayload().activated?Object(F.jsx)($,{}):Object(F.jsx)(_,{}):Object(F.jsx)(A,{})})},e}return a}(n.Component),Z={email:""},G=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onSubmit=function(e){e.preventDefault()},n.render=function(){return Object(F.jsx)("main",{children:Object(F.jsx)("section",{className:"section-only",children:Object(F.jsxs)("form",{className:"form-only",onSubmit:n.onSubmit,children:[Object(F.jsx)("img",{className:"logo-img",src:"/logo.png",alt:"CloudDrive16 logo"}),Object(F.jsx)("h1",{className:"h1-only",children:"Find my account"}),Object(F.jsxs)("div",{className:"form-group-email",children:[Object(F.jsx)("input",{className:"input-email",type:"email",name:"email",placeholder:"Email",value:n.state.email,pattern:j.emailPattern,onInput:n.enterEmail,onInvalid:n.enterEmail,onChange:n.setEmail,title:"Please fill out this field.",required:!0}),Object(F.jsx)("button",{className:"btn-input",type:"submit",disabled:!n.state.email,hidden:!0,children:Object(F.jsx)("i",{className:"material-icons",children:"input"})})]})]})})})},n.state=Z,n}return a}(n.Component),X=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).render=function(){return Object(F.jsxs)(d.a,{children:[Object(F.jsx)(E,{}),Object(F.jsx)(u.a,{exact:!0,path:"/",component:W}),Object(F.jsx)(u.a,{path:"/find-account",component:G})]})},e}return a}(n.Component),ee=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,117)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,o=t.getTTFB;a(e),n(e),r(e),s(e),o(e)}))};o.a.render(Object(F.jsx)(r.a.StrictMode,{children:Object(F.jsx)(X,{})}),document.getElementById("root")),ee()},69:function(e,t,a){},70:function(e,t,a){}},[[111,1,2]]]);
//# sourceMappingURL=main.e6fb51a3.chunk.js.map